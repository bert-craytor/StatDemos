<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Burlingame Housing Market Cluster Analysis</title>
  
  <!-- Add Tailwind CSS for styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Add React and ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  
  <!-- Add Babel for JSX transpilation -->
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  
  <!-- Add Recharts for visualization -->
  <script src="https://unpkg.com/recharts/umd/Recharts.js"></script>
  
  <!-- Add Lodash and Math.js -->
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjs@11.5.0/lib/browser/math.min.js"></script>
</head>
<body>
  <div id="root" class="p-4"></div>

  <script type="text/babel">
    // Mock data for demonstration (since we can't load the Excel file)
    const mockData = [
      {
        "ID": 1, "Address": "175 Pepper AVE", "Sale Price": 5100000, "GLA": 4880, "Lot Size": 19000,
        "Age": 114, "Bathrooms": 4, "Bedroooms": 8, "Area Name": "Burlingame Park", "cluster": 2
      },
      {
        "ID": 2, "Address": "2924 Hillside DR", "Sale Price": 2340000, "GLA": 1670, "Lot Size": 6780,
        "Age": 82, "Bathrooms": 2, "Bedroooms": 3, "Area Name": "Burlingame Hills / Skyline Terrace", "cluster": 0
      },
      {
        "ID": 3, "Address": "1000 Paloma AVE", "Sale Price": 1998000, "GLA": 1720, "Lot Size": 3500,
        "Age": 95, "Bathrooms": 2.5, "Bedroooms": 4, "Area Name": "Burlingame Terrace-Easton Addition", "cluster": 0
      },
      {
        "ID": 4, "Address": "21 Stanley RD", "Sale Price": 1800000, "GLA": 1340, "Lot Size": 5750,
        "Age": 110, "Bathrooms": 2, "Bedroooms": 3, "Area Name": "Lyon-Hoag", "cluster": 0
      },
      {
        "ID": 5, "Address": "120 Occidental AVE", "Sale Price": 3950000, "GLA": 3240, "Lot Size": 7000,
        "Age": 12, "Bathrooms": 4.5, "Bedroooms": 5, "Area Name": "Burlingame Park", "cluster": 1
      },
      {
        "ID": 6, "Address": "1433 Benito AVE", "Sale Price": 3250000, "GLA": 2530, "Lot Size": 6100,
        "Age": 78, "Bathrooms": 3, "Bedroooms": 4, "Area Name": "Ray Park", "cluster": 3
      }
    ];

    // Create a component with mocked data instead of loading from Excel
    const BurlingameHousingClusters = () => {
      const data = mockData;
      const clusterColors = ['#3366cc', '#dc3912', '#ff9900', '#109618'];
      const [scatterView, setScatterView] = React.useState('price-gla');
      
      // Calculate cluster statistics
      const clusterStats = {
        "0": {
          count: 3,
          features: {
            "Sale Price": { mean: 2046000, median: 1998000, min: 1800000, max: 2340000 },
            "GLA": { mean: 1576, median: 1670, min: 1340, max: 1720 },
            "Lot Size": { mean: 5343, median: 5750, min: 3500, max: 6780 },
            "Age": { mean: 95, median: 95, min: 82, max: 110 },
            "Bathrooms": { mean: 2.2, median: 2, min: 2, max: 2.5 },
            "Bedroooms": { mean: 3.3, median: 3, min: 3, max: 4 }
          }
        },
        "1": {
          count: 1,
          features: {
            "Sale Price": { mean: 3950000, median: 3950000, min: 3950000, max: 3950000 },
            "GLA": { mean: 3240, median: 3240, min: 3240, max: 3240 },
            "Lot Size": { mean: 7000, median: 7000, min: 7000, max: 7000 },
            "Age": { mean: 12, median: 12, min: 12, max: 12 },
            "Bathrooms": { mean: 4.5, median: 4.5, min: 4.5, max: 4.5 },
            "Bedroooms": { mean: 5, median: 5, min: 5, max: 5 }
          }
        },
        "2": {
          count: 1,
          features: {
            "Sale Price": { mean: 5100000, median: 5100000, min: 5100000, max: 5100000 },
            "GLA": { mean: 4880, median: 4880, min: 4880, max: 4880 },
            "Lot Size": { mean: 19000, median: 19000, min: 19000, max: 19000 },
            "Age": { mean: 114, median: 114, min: 114, max: 114 },
            "Bathrooms": { mean: 4, median: 4, min: 4, max: 4 },
            "Bedroooms": { mean: 8, median: 8, min: 8, max: 8 }
          }
        },
        "3": {
          count: 1,
          features: {
            "Sale Price": { mean: 3250000, median: 3250000, min: 3250000, max: 3250000 },
            "GLA": { mean: 2530, median: 2530, min: 2530, max: 2530 },
            "Lot Size": { mean: 6100, median: 6100, min: 6100, max: 6100 },
            "Age": { mean: 78, median: 78, min: 78, max: 78 },
            "Bathrooms": { mean: 3, median: 3, min: 3, max: 3 },
            "Bedroooms": { mean: 4, median: 4, min: 4, max: 4 }
          }
        }
      };
      
      const scatterViewOptions = [
        { id: 'price-gla', label: 'Price vs. Size', x: 'GLA', y: 'Sale Price' },
        { id: 'price-lot', label: 'Price vs. Lot Size', x: 'Lot Size', y: 'Sale Price' },
        { id: 'gla-lot', label: 'Size vs. Lot Size', x: 'Lot Size', y: 'GLA' },
        { id: 'price-age', label: 'Price vs. Age', x: 'Age', y: 'Sale Price' }
      ];
      
      // Format currency
      const formatCurrency = (value) => {
        return new Intl.NumberFormat('en-US', {
          style: 'currency',
          currency: 'USD',
          maximumFractionDigits: 0
        }).format(value);
      };
      
      // Format number with commas
      const formatNumber = (value) => {
        return new Intl.NumberFormat('en-US').format(value);
      };
      
      const CustomTooltip = ({ active, payload }) => {
        if (active && payload && payload.length) {
          const property = payload[0].payload;
          
          return (
            <div className="bg-white p-4 border border-gray-200 shadow-md rounded-md">
              <p className="font-bold">{property.Address}</p>
              <p>{formatCurrency(property['Sale Price'])}</p>
              <p>{formatNumber(property.GLA)} sq.ft.</p>
              <p>Lot: {formatNumber(property['Lot Size'])} sq.ft.</p>
              <p>Age: {property.Age} years</p>
              <p>Beds: {property.Bedroooms} / Baths: {property.Bathrooms}</p>
            </div>
          );
        }
        
        return null;
      };
      
      const getClusterName = (index) => {
        switch(index) {
          case 0: return "Cluster 1: Entry-Level Homes";
          case 1: return "Cluster 2: Luxury New Construction";
          case 2: return "Cluster 3: Estate Properties";
          case 3: return "Cluster 4: Mid-Range Homes";
          default: return `Cluster ${index + 1}`;
        }
      };
      
      const getClusterDescription = (index) => {
        switch(index) {
          case 0: return "Smaller, older homes with lower price points";
          case 1: return "Newer, larger homes with premium features";
          case 2: return "Large homes on expansive lots";
          case 3: return "Mid-sized homes with good amenities";
          default: return "";
        }
      };
      
      // Get current scatter view configuration
      const currentView = scatterViewOptions.find(v => v.id === scatterView);
      
      return (
        <div className="p-4">
          <h1 className="text-2xl font-bold mb-4">Burlingame Housing Market Cluster Analysis</h1>
          
          <div className="mb-6">
            <h2 className="text-xl font-semibold mb-2">Cluster Overview</h2>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
              {Object.keys(clusterStats).map(cluster => (
                <div 
                  key={cluster} 
                  className="border rounded-lg p-4 shadow-sm"
                  style={{ borderLeftWidth: '4px', borderLeftColor: clusterColors[cluster] }}
                >
                  <h3 className="font-bold">{getClusterName(parseInt(cluster))}</h3>
                  <p className="text-sm text-gray-600 mb-2">{getClusterDescription(parseInt(cluster))}</p>
                  
                  <div className="grid grid-cols-2 gap-2 text-sm">
                    <div>Properties:</div>
                    <div className="font-semibold text-right">{clusterStats[cluster].count}</div>
                    
                    <div>Avg. Price:</div>
                    <div className="font-semibold text-right">
                      {formatCurrency(clusterStats[cluster].features['Sale Price'].mean)}
                    </div>
                    
                    <div>Avg. Size:</div>
                    <div className="font-semibold text-right">
                      {formatNumber(Math.round(clusterStats[cluster].features.GLA.mean))} sq.ft.
                    </div>
                    
                    <div>Avg. Lot:</div>
                    <div className="font-semibold text-right">
                      {formatNumber(Math.round(clusterStats[cluster].features['Lot Size'].mean))} sq.ft.
                    </div>
                    
                    <div>Avg. Age:</div>
                    <div className="font-semibold text-right">
                      {Math.round(clusterStats[cluster].features.Age.mean)} years
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>
          
          <div>
            <h2 className="text-xl font-semibold mb-2">Detailed Cluster Statistics</h2>
            <div className="overflow-x-auto">
              <table className="min-w-full divide-y divide-gray-200">
                <thead>
                  <tr>
                    <th className="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cluster</th>
                    <th className="px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Count</th>
                    <th className="px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Avg. Price</th>
                    <th className="px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Price Range</th>
                    <th className="px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Avg. Size</th>
                    <th className="px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Avg. Lot Size</th>
                    <th className="px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Avg. Age</th>
                    <th className="px-6 py-3 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Beds/Baths</th>
                  </tr>
                </thead>
                <tbody className="bg-white divide-y divide-gray-200">
                  {Object.entries(clusterStats).map(([cluster, stats]) => (
                    <tr key={cluster}>
                      <td className="px-6 py-4 whitespace-nowrap">
                        <div className="flex items-center">
                          <div 
                            className="w-4 h-4 mr-2 rounded-full" 
                            style={{ backgroundColor: clusterColors[cluster] }}
                          ></div>
                          <div>
                            <div className="font-medium">{getClusterName(parseInt(cluster))}</div>
                            <div className="text-xs text-gray-500">{getClusterDescription(parseInt(cluster))}</div>
                          </div>
                        </div>
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-right">
                        {stats.count}
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-right">
                        {formatCurrency(stats.features['Sale Price'].mean)}
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-right">
                        {formatCurrency(stats.features['Sale Price'].min)} - {formatCurrency(stats.features['Sale Price'].max)}
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-right">
                        {formatNumber(Math.round(stats.features.GLA.mean))} sq.ft.
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-right">
                        {formatNumber(Math.round(stats.features['Lot Size'].mean))} sq.ft.
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-right">
                        {Math.round(stats.features.Age.mean)} years
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-right">
                        {stats.features.Bedroooms.mean.toFixed(1)}/{stats.features.Bathrooms.mean.toFixed(1)}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      );
    };

    // Render the component
    ReactDOM.render(<BurlingameHousingClusters />, document.getElementById('root'));
  </script>
</body>
</html>